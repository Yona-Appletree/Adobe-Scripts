//// created by JK Keller, dilettante coder// http://jk-keller.com//// I WOULDN'T USE THIS AS IS. PROCESSING IS SO MUCH BETTER AT THIS MANIPULATION...// Mountain shift// if the diff of colors is great enough,// get the vert location// then select the column// then shift up or down// then make a txt file of numbers// enable double clicking from the Macintosh Finder or the Windows Explorer#target photoshop// in case we double clicked the fileapp.bringToFront();var docRef = app.activeDocumentvar activeLayerName = docRef.activeLayer.name;app.preferences.rulerUnits = Units.PIXELS app.displayDialogs = DialogModes.NOdocRef.activeLayer = docRef.layers["guide"];// starting valuesvar checkColor = new SolidColor();checkColor.rgb.red   = 255;checkColor.rgb.green = 255;checkColor.rgb.blue  = 255;//var docWidth = 10;var docWidth = docRef.width;var docHeight = docRef.height;////////////////// check////////////////// checkvar aHeights = new Array();var jStart = prompt("start at what x height?", "1500")*1;var horizonVal = jStart;var jDirection = "down";// get pixel color (from xbytor http://www.ps-scripts.com/bb/viewtopic.php?=&p=3078)function getColorAt(pDoc, x, y) {	selectBounds(pDoc, [x, y, x+1, y+1]);	var pColor = new SolidColor();   	pColor.rgb.red   = findPV(pDoc.channels["Red"].histogram);	pColor.rgb.green = findPV(pDoc.channels["Green"].histogram)	pColor.rgb.blue  = findPV(pDoc.channels["Blue"].histogram);	pDoc.selection.deselect(); // or, even better, undo		return pColor;};function selectBounds(pDoc, pRect) {	pDoc.selection.select([[ pRect[0], pRect[1] ],[ pRect[2], pRect[1] ],[ pRect[2], pRect[3] ],[ pRect[0], pRect[3] ]]);}function findPV(pHist) {	for (var i = 0; i <= 255; i++ ) {		if (pHist[i]) { return i; }	}	return 0;}for (var i=0; i<docWidth; i++) {	docRef.activeLayer = docRef.layers["guide"];	if (jDirection == "up") {		for (var j=jStart; j>0; j--) {			var tColor = getColorAt(docRef, i, j);			if (tColor.rgb.red != checkColor.rgb.red || tColor.rgb.green != checkColor.rgb.green || tColor.rgb.blue != checkColor.rgb.blue) {				jStart = j;				//alert(j);				break;			};		};	};	for (var j=jStart; j<docHeight; j++) {		var tColor = getColorAt(docRef, i, j);		if (tColor.rgb.red == checkColor.rgb.red && tColor.rgb.green == checkColor.rgb.green && tColor.rgb.blue == checkColor.rgb.blue) {			//aHeights.push(j);			docRef.activeLayer = docRef.layers["image1"];			selectBounds(docRef, [i, 0, i+1, docHeight]);//			alert(i);//			alert(horizonVal-j);			docRef.selection.translate(0,horizonVal-j);			selectBounds(docRef, [i, 0, i+1, docHeight]);			try {				docRef.selection.rotate(360);			} catch(errorr) {				docRef.activeLayer = docRef.layers["image2"];				selectBounds(docRef, [i-1, 0, i, docHeight]);				docRef.selection.translate(0,horizonVal-j);//				alert ("maybe?") ;			}			selectBounds(docRef, [i, 0, i+1, docHeight]);			try {				docRef.selection.rotate(360);			} catch(errorr) {				docRef.activeLayer = docRef.layers["image3"];				selectBounds(docRef, [i-2, 0, i-1, docHeight]);				docRef.selection.translate(0,horizonVal-j);//				alert ("maybe?") ;			}			jStart = j;			jDirection = "up";			//alert(j);			break;		};	};};// docRef.close();